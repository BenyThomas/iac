# Audit rules for Kubernetes node baseline
# Generated by security_hardening role

-w /etc/passwd -p wa -k identity
-w /etc/group -p wa -k identity
-w /etc/shadow -p wa -k identity
-w /etc/sudoers -p wa -k scope
-w /etc/sudoers.d/ -p wa -k scope
-w /etc/ssh/sshd_config -p wa -k sshd

# Monitor time changes
-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k time-change
-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k time-change
-a always,exit -F arch=b64 -S stime -k time-change
-a always,exit -F arch=b32 -S stime -k time-change
-w /etc/localtime -p wa -k time-change

# Monitor network environment changes
-a always,exit -F arch=b64 -S sethostname,setdomainname -k network-modifications
-a always,exit -F arch=b32 -S sethostname,setdomainname -k network-modifications
-w /etc/issue -p wa -k network-modifications
-w /etc/issue.net -p wa -k network-modifications
-w /etc/hosts -p wa -k network-modifications
-w /etc/sysconfig/network -p wa -k network-modifications
-w /etc/sysconfig/network-scripts/ -p wa -k network-modifications
-w /etc/network/ -p wa -k network-modifications

# Monitor login and session activity
-w /var/log/lastlog -p wa -k session
-w /var/run/faillock/ -p wa -k session
-w /var/log/faillog -p wa -k session
-w /var/log/tallylog -p wa -k session

# Ensure auditd cannot be stopped without logging
-e 2
